{# navbar.html #}
{% set on_homepage = request.endpoint == 'main.index' %}
<nav id="siteNav"
     class="fixed inset-x-0 top-0 z-50 h-16 flex items-center
            {{ 'text-white'           if on_homepage else 'text-neutral-900' }}
            {{ ''                     if on_homepage else 'bg-white/60 backdrop-blur-md text-neutral-900 shadow-sm' }}">
  <div class="mx-auto max-w-7xl w-full px-4 sm:px-6 lg:px-8 flex items-center justify-between">

    <!-- Brand icon -->
    <a href="{{ url_for('main.index') }}" class="text-x1 font-serif tracking-wide drop-shadow">
      <img src="{{ url_for('main.static', filename='img/logo_nav.png') }}"
           alt="Elite Dating Search logo"
           class="h-12 w-auto"/>
    </a>
    
    <!-- Desktop menu -->
    <ul class="hidden md:flex items-center text-[15px] font-semibold tracking-wide space-x-10">
      <!-- ✨ Professional Matchmaking Services dropdown -->
      <li class="relative group">
        <button class="nav-link inline-flex items-center space-x-1 focus:outline-none">
          <span>Professional Matchmaking Services</span>
          <svg class="h-3 w-3 mt-0.5 opacity-70 transition-transform group-hover:rotate-180"
               fill="currentColor" viewBox="0 0 20 20"><path d="M5 7l5 5 5-5H5z"/></svg>
        </button>
        <ul class="absolute left-0 top-full w-64 rounded-xl bg-white shadow-xl ring-1 ring-[#d4af37]/50
                   opacity-0 invisible group-hover:opacity-100 group-hover:visible transform scale-95
                   group-hover:scale-100 transition-all duration-200">
          <li><a href="{{ url_for('main.matchmaking_services') }}"
                 class="block px-5 py-3 text-sm text-gray-700 hover:bg-[#f8f5ec] hover:text-[#d4af37] transition-colors">
                 Overview of Services</a></li>
          <li><a href="{{ url_for('program.client') }}"
                 class="block px-5 py-3 text-sm text-gray-700 hover:bg-[#f8f5ec] hover:text-[#d4af37] transition-colors">
                 Client Program</a></li>
          <li><a href="{{ url_for('program.candidate') }}"
                 class="block px-5 py-3 text-sm text-gray-700 hover:bg-[#f8f5ec] hover:text-[#d4af37] transition-colors">
                 Candidate Program (Complimentary)</a></li>
        </ul>
      </li>
    
      <!-- Our Process -->
      <li><a href="{{ url_for('main.our_process') }}" class="nav-link">Our Process</a></li>
    
      <!-- Proven Results dropdown -->
      <li class="relative group">
        <button class="nav-link inline-flex items-center space-x-1 focus:outline-none">
          <span>Proven Results</span>
          <svg class="h-3 w-3 mt-0.5 opacity-70 transition-transform group-hover:rotate-180"
               fill="currentColor" viewBox="0 0 20 20"><path d="M5 7l5 5 5-5H5z"/></svg>
        </button>
        <ul class="absolute left-0 top-full w-56 rounded-xl bg-white shadow-xl ring-1 ring-[#d4af37]/50
                   opacity-0 invisible group-hover:opacity-100 group-hover:visible transform scale-95
                   group-hover:scale-100 transition-all duration-200">
          <li><a href="{{ url_for('main.roi_of_love') }}"
                 class="block px-5 py-3 text-sm text-gray-700 hover:bg-[#f8f5ec] hover:text-[#d4af37] transition-colors">
                 ROI of Love</a></li>
          <li><a href="{{ url_for('main.testimonials') }}"
                 class="block px-5 py-3 text-sm text-gray-700 hover:bg-[#f8f5ec] hover:text-[#d4af37] transition-colors">
                 Testimonials</a></li>
        </ul>
      </li>
    
      <li><a href="{{ url_for('main.about_us') }}" class="nav-link">About Us</a></li>
    </ul>
    
    {# ───── CTA / AUTH LINKS (desktop) ───── #}
    {% if current_user.is_authenticated %}
  <div class="hidden md:flex items-center space-x-6
  				 {{ 'text-white'           if on_homepage else 'text-neutral-900' }}">
    <span class="text-sm font-semibold">
      Welcome, {{ current_user.profile.first_name or current_user.email }}
    </span>

    {# link visible only for reps (and admins who hold the role) #}
    {% if current_user.has_role("rep") %}
      <a href="{{ url_for('chat.rep_dashboard') }}" class="px-3 py-2">
        Rep Dashboard
      </a>
    {% endif %}
    
    {% if current_user.is_authenticated and current_user.has_role('admin') %}
  <a href="{{ url_for('admin.users') }}">Admin Dashboard</a>
{% endif %}
    
    <a href="{{ url_for('auth.logout') }}" class="btn btn-primary">
      Log&nbsp;out
    </a>
  </div>
{% else %}
  <div class="hidden md:flex items-center space-x-4">
    <a href="{{ url_for('auth.login') }}"    class="nav-link">Log in</a>
    <a href="{{ url_for('auth.register') }}" class="btn btn-primary">
      Sign&nbsp;up
    </a>
  </div>
{% endif %}
    
    <!-- Mobile hamburger -->
    <button id="nav-toggle"
            class="md:hidden flex items-center h-10 w-10 justify-center rounded ring-1 ring-black/10
                   hover:ring-black/20 transition">
      <span class="sr-only">Toggle menu</span>
      <svg id="nav-icon" class="h-5 w-5" viewBox="0 0 24 24" stroke="currentColor" fill="none">
        <path stroke-linecap="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"/>
      </svg>
    </button>
  </div>

  <!-- Mobile drawer -->
  <div id="mobile-menu"
       class="md:hidden bg-white shadow-lg border-t border-gray-100 absolute inset-x-0 top-full
              origin-top scale-y-0 transition-transform">
    <ul class="flex flex-col text-base font-medium divide-y divide-gray-100">
      <li><a href="{{ url_for('main.matchmaking_services') }}" class="mobile-link">Overview of Services</a></li>
      <li><a href="{{ url_for('program.client') }}"       class="mobile-link">Client Program</a></li>
      <li><a href="{{ url_for('program.candidate') }}"    class="mobile-link">Candidate Program (Complimentary)</a></li>
      <li><a href="{{ url_for('main.our_process') }}"          class="mobile-link">Our Process</a></li>
      <li><a href="{{ url_for('main.roi_of_love') }}"          class="mobile-link">ROI of Love</a></li>
      <li><a href="{{ url_for('main.testimonials') }}"         class="mobile-link">Testimonials</a></li>
      <li><a href="{{ url_for('main.about_us') }}"             class="mobile-link">About Us</a></li>

      {# ───── AUTH LINKS (mobile) ───── #}
      {% if current_user.is_authenticated %}
        <li><a href="{{ url_for('auth.logout') }}" class="mobile-link text-rose-600">Log out</a></li>
      {% else %}
        <li><a href="{{ url_for('auth.login') }}"    class="mobile-link">Log in</a></li>
        <li><a href="{{ url_for('auth.register') }}" class="mobile-link font-semibold text-rose-600">Sign up</a></li>
      {% endif %}
    </ul>
  </div>

  <script>
    document.addEventListener('DOMContentLoaded', () => {
      const btn  = document.getElementById('nav-toggle');
      const menu = document.getElementById('mobile-menu');
      btn.addEventListener('click', () => {
        menu.classList.toggle('scale-y-0');
        menu.classList.toggle('scale-y-100');
      });
    });
  </script>
</nav>